{"version":3,"sources":["../../backend/routes/productRoute.js"],"names":["router","express","Router","get","req","res","query","search","Product","find","err","products","send","item","category","isAuth","isAdmin","Purchase","foundGoods","findById","params","id","product","status","message","post","name","body","price","image","brand","countInStock","description","rating","numReviews","save","newProduct","data","put","foundProduct","deletedProduct","remove","order_time","order_id","customer_name","customer_email","order_amount","item_number","shipping","items","forEach","push","purchasedProduct","cleared","clearedProduct"],"mappings":"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","sourcesContent":["import express, { Router } from \"express\";\r\nimport  { Product, Purchase } from \"../models/productModel\"\r\nimport { isAuth, isAdmin } from \"../util\";\r\n\r\nconst router = express.Router();\r\n\r\nrouter.get(\"/\", async (req, res) => { \r\n    if(req.query.search && req.query.search === \"all\") {\r\n        Product.find({}, (err, products) => {\r\n            res.send(products);\r\n        });\r\n    } else if(req.query.search && req.query.search !== \"undefined\") {\r\n        const item = req.query.search;\r\n        Product.find({category: item}, (err, products) => {\r\n            res.send(products);\r\n        });\r\n    } else {\r\n        Product.find({category: \"Shirt\"}, (err, products) => {\r\n            res.send(products);\r\n        }); \r\n    }\r\n});\r\n\r\nrouter.get(\"/soldout\", isAuth, isAdmin, (req, res) => {\r\n    Purchase.find({}, (err, foundGoods) => {\r\n        if(err) {\r\n            return res.send(\"Error while searching sold goods\")\r\n        }\r\n            res.send(foundGoods);\r\n    })\r\n})\r\n\r\n \r\nrouter.get(\"/:id\", (req, res) => {\r\n    Product.findById(req.params.id, (err, product) => {\r\n        if(err){\r\n            return res.status(400).send({message: \"Product Not Found\"});\r\n        }\r\n            res.send(product);\r\n    });\r\n})\r\n\r\nrouter.post(\"/\", isAuth, isAdmin, async (req, res) => {\r\n    const product = new Product ({\r\n        name: req.body.name,\r\n        price: req.body.price,\r\n        image: req.body.image,\r\n        category: req.body.category,\r\n        brand: req.body.brand,\r\n        countInStock: req.body.countInStock,\r\n        description: req.body.description,\r\n        rating: req.body.rating,\r\n        numReviews: req.body.numReviews\r\n    });\r\n    product.save((err, newProduct) => {\r\n        if(err){\r\n            return res.status(500).send({message: \"Error while creating Product\"});\r\n        }\r\n        return res.status(201).send({message: \"New Product Created\", data: newProduct});\r\n    });\r\n});\r\n\r\nrouter.put(\"/:id\", isAuth, isAdmin, async (req, res) => {\r\n    const product = await Product.findById(req.params.id);\r\n        product.name = req.body.name;\r\n        product.price = req.body.price;\r\n        product.image = req.body.image;\r\n        product.category = req.body.category;\r\n        product.brand = req.body.brand;\r\n        product.countInStock = req.body.countInStock;\r\n        product.description = req.body.description;\r\n        product.rating = req.body.rating;\r\n        \r\n        product.save((err,foundProduct) => {\r\n            if(err) {\r\n                return res.status(500).send({message: \"Error while updating Product\"});\r\n            }\r\n            return res.status(200).send({message: \"Product Updated\", data: foundProduct});\r\n        });\r\n    });\r\n\r\nrouter.delete(\"/:id\", isAuth, isAdmin, async (req, res) => {\r\n    const deletedProduct = await Product.findById(req.params.id);\r\n    if(deletedProduct) {\r\n        await deletedProduct.remove();\r\n        return res.send({message: \"Product Deleted\", data: deletedProduct});\r\n    }\r\n    return res.status(500).send({message: \"Error while deleteting Product\"});\r\n})\r\n\r\nrouter.post(\"/purchase\", isAuth, async (req, res) => {\r\n    const product = new Purchase ({\r\n        order_time: req.body.order_time, \r\n        order_id: req.body.order_id, \r\n        customer_name: req.body.customer_name, \r\n        customer_email: req.body.customer_email,\r\n        order_amount: req.body.order_amount,\r\n        item_number: req.body.item_number,\r\n        shipping: req.body.shipping\r\n    }); \r\n\r\n    const items = req.body.items;\r\n    items.forEach(function(item) {\r\n        product.items.push(item);\r\n    })\r\n\r\n    product.save((err, purchasedProduct) => {\r\n        if(err){\r\n            return res.status(500).send({message: \"Error while saving purchased product\"});\r\n        }\r\n        return res.status(201).send({message: \"New Product Created\", data: purchasedProduct});\r\n    });\r\n})\r\n\r\nrouter.get(\"/soldout/:id\", async (req, res) => {\r\n    const product = await Purchase.findById(req.params.id)\r\n    product.cleared = true;\r\n    product.save((err, clearedProduct) => {\r\n        if(err) {\r\n            return res.status(500).send({message: \"Error while saving purchased product\"});\r\n        }\r\n        return res.status(201).send({message: \"New Product Created\", data: clearedProduct});\r\n    })\r\n})\r\n\r\n\r\n\r\nexport default router;"],"file":"productRoute.js"}